<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Registro de Inventario</title>
</head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
    background: #f4f7fa;
    margin: 0;
    padding: 0;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
  }
  h2 {
    margin-top: 32px;
    color: #2d3748;
    font-size: 1.45rem;
    letter-spacing: 0.5px;
    font-weight: 600;
    font-family: inherit;
  }
  form {
    background: #fff;
    padding: 22px 16px 18px 16px;
    border-radius: 14px;
    box-shadow: 0 4px 24px rgba(37, 99, 235, 0.13), 0 1.5px 8px rgba(0,0,0,0.07);
    width: 100%;
    max-width: 350px;
    display: flex;
    flex-direction: column;
    gap: 13px;
    margin-top: 18px;
    border: 2px solid #2563eb;
  }
  label {
    display: flex;
    flex-direction: column;
    font-size: 1rem;
    color: #374151;
    gap: 3px;
    margin-bottom: 1px;
    font-weight: 500;
    font-family: inherit;
  }
  input[type="text"],
  input[type="number"],
  select {
    padding: 9px 11px;
    border: 1px solid #7bb0e7;
    border-radius: 6px;
    font-size: 1rem;
    background: #eaf3fb;
    transition: border 0.18s, background 0.18s;
    color: #2d3748;
    font-weight: 400;
    font-family: inherit;
    margin-bottom: 10px;
  }

  /* Uniformar el campo Producto (readonly) */
  #productoInput[readonly] {
    background: #eaf3fb !important;
    color: #2d3748;
    border: 1px solid #7bb0e7;
  }
  input:focus, select:focus {
    border-color: #7bb0e7;
    outline: none;
    background: #fff;
  }
  input[readonly] {
    background: #e9eef5 !important;
    color: #8a99b3;
  }
  button[type="submit"],
  button[type="button"] {
    background: #e6f0fa;
    color: #2d3748;
    border: 1px solid #cfd8e3;
    border-radius: 6px;
    padding: 10px 0;
    font-size: 1rem;
    font-weight: 500;
    cursor: pointer;
    transition: background 0.18s, border 0.18s;
    margin-top: 7px;
    font-family: inherit;
    min-width: 120px;
    max-width: 180px;
    width: 100%;
  }

  /* Botones de Editar y Eliminar en la tabla: tamaño original */
  .btnEditar, .btnEliminar {
    min-width: unset !important;
    max-width: unset !important;
    width: auto !important;
    padding: 2px 7px !important;
    font-size: 0.92em !important;
  }
  button[type="submit"] {
    background: #2563eb;
    color: #fff;
    border: none;
    margin-top: 7px;
    box-shadow: 0 2px 8px rgba(37,99,235,0.08);
    font-weight: 600;
    letter-spacing: 0.5px;
    transition: background 0.18s, box-shadow 0.18s;
    min-width: 90px;
    max-width: 140px;
    width: 60%;
    height: 48px;
    font-size: 1.08rem;
    align-self: center;
  }
  button[type="submit"]:hover {
    background: #1746a2;
    box-shadow: 0 4px 16px rgba(37,99,235,0.13);
  }
  button[type="button"]:hover {
    background: #f0f6fb;
    border-color: #b6c6db;
  }
  #btnEnviar {
    background: #a3e3c6;
    color: #22694d;
    border: none;
    margin-top: 7px;
    font-family: inherit;
    width: 100%;
    min-width: unset;
    max-width: unset;
    height: 48px;
    font-size: 1.08rem;
    font-weight: 600;
    letter-spacing: 0.5px;
    align-self: center;
    box-shadow: 0 2px 8px rgba(37,99,235,0.08);
    transition: background 0.18s, box-shadow 0.18s;
  }
  #btnEnviar:hover {
    background: #7fd6b2;
  }
  #btnDescargar {
    background: #2563eb;
    color: #fff;
    border: none;
    margin-top: 7px;
    font-family: inherit;
    width: 100%;
    height: 48px;
    font-size: 1.08rem;
    font-weight: 600;
    letter-spacing: 0.5px;
    align-self: center;
    box-shadow: 0 2px 8px rgba(37,99,235,0.08);
    transition: background 0.18s, box-shadow 0.18s;
  }
  #btnDescargar:hover {
    background: #1746a2;
  }
  #btnLimpiar {
    background: #e0e0e0;
    color: #444;
    border: none;
    font-family: inherit;
    width: 100%;
    height: 48px;
    font-size: 1.08rem;
    font-weight: 600;
    letter-spacing: 0.5px;
    align-self: center;
    margin-top: 7px;
    box-shadow: 0 2px 8px rgba(37,99,235,0.08);
    transition: background 0.18s, box-shadow 0.18s;
  }
  #btnLimpiar:hover {
    background: #cccccc;
  }
  #mensaje {
    margin-top: 16px;
    color: #5393d6;
    font-size: 1.05rem;
    text-align: center;
    min-height: 22px;
    font-weight: 500;
    font-family: inherit;
  }
  table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    background: #eaf3fb;
    border-radius: 10px;
    box-shadow: 0 2px 12px rgba(60, 120, 180, 0.07);
    font-size: 0.97rem;
    margin-top: 18px;
    border: 2px solid #2563eb;
    overflow: hidden;
    font-family: inherit;
  }
  thead tr {
    background: #e6f0fa;
    color: #2d3748;
    font-weight: 600;
    font-family: inherit;
  }
  th, td {
    padding: 8px 6px;
    border-bottom: 1px solid #e3e8f0;
    text-align: left;
    font-family: inherit;
  }
  th:last-child, td:last-child {
    border-right: none;
  }
  tr:last-child td {
    border-bottom: none;
  }
  @media (max-width: 480px) {
    form {
      padding: 12px 2px 10px 2px;
      max-width: 98vw;
    }
    h2 {
      font-size: 1.1rem;
    }
    table {
      font-size: 0.93rem;
    }
  }
</style>
</head>
<body>
  <form id="registroForm" autocomplete="off">
    <h2 style="margin:0 0 18px 0;text-align:center;font-size:1.25rem;font-weight:600;color:#222;letter-spacing:0.5px;">
      <span style="vertical-align:middle;font-size:2em;margin-right:10px;">📝</span>Registro de Inventario
    </h2>
    <label>Nombre
      <input type="text" name="nombre" required placeholder="Nombre completo" autocomplete="off" list="listaNombres">
      <datalist id="listaNombres"></datalist>
    </label>
    <label>Área
      <input type="text" name="area" required placeholder="Área" autocomplete="off" list="listaAreas" id="areaInput">
      <datalist id="listaAreas"></datalist>
    </label>
    <label>Código
      <input type="text" name="codigo" required id="codigoInput" placeholder="Escriba o seleccione código" list="listaCodigos" autocomplete="off" disabled inputmode="numeric" pattern="[0-9]*">
      <datalist id="listaCodigos"></datalist>
    </label>
    <div style="display:flex;flex-direction:column;gap:3px;margin-bottom:1px;">
      <input type="text" name="producto" required placeholder="Producto" id="productoInput" readonly style="background:#e9ecef;" disabled>
    </div>
    <label>Cilindros
      <input type="number" name="cilindros" required min="0" placeholder="Cantidad de cilindros" disabled inputmode="numeric" pattern="[0-9]*">
    </label>
    <div style="display:flex;justify-content:center;width:100%;margin-top:8px;">
      <button type="submit">Registrar</button>
    </div>
  </form>
  <div style="width:100%;max-width:370px;margin:0 auto;overflow-x:auto;">
    <table id="tablaRegistros" style="width:100%;border-collapse:collapse;margin-top:18px;background:#fff;border-radius:8px;box-shadow:0 1px 4px rgba(0,0,0,0.04);font-size:0.97rem;">
      <thead>
        <tr style="background:#f1f3f6;color:#222;">
          <th style="padding:7px 4px;border-bottom:1px solid #e0e0e0;">ID</th>
          <th style="padding:7px 4px;border-bottom:1px solid #e0e0e0;">Código</th>
          <th style="padding:7px 4px;border-bottom:1px solid #e0e0e0;">Producto</th>
          <th style="padding:7px 4px;border-bottom:1px solid #e0e0e0;">Cilindros</th>
          <th style="padding:7px 4px;border-bottom:1px solid #e0e0e0; text-align:center;">Acciones</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

  <p id="mensaje" style="margin-top:10px;"></p>
  <p id="agradecimiento" style="margin-top:2px;color:#28a745;font-weight:600;text-align:center;"></p>
  <div style="width:100%;max-width:370px;margin:0 auto;display:flex;justify-content:center;gap:10px;">
    <button type="button" id="btnDescargar" style="background:#2563eb;color:#fff;width:33.33%;height:48px;font-size:1.08rem;font-weight:600;letter-spacing:0.5px;align-self:center;margin-top:10px;box-shadow:0 2px 8px rgba(37,99,235,0.08);transition:background 0.18s,box-shadow 0.18s;border:none;">Descargar</button>
    <button type="button" id="btnEnviar" style="background:#28a745;color:#fff;width:33.33%;height:48px;font-size:1.08rem;font-weight:600;letter-spacing:0.5px;align-self:center;margin-top:10px;box-shadow:0 2px 8px rgba(37,99,235,0.08);transition:background 0.18s,box-shadow 0.18s;border:none;">Enviar</button>
    <button type="button" id="btnLimpiar" style="background:#e0e0e0;color:#444;width:33.33%;height:48px;font-size:1.08rem;font-weight:600;letter-spacing:0.5px;align-self:center;margin-top:10px;box-shadow:0 2px 8px rgba(37,99,235,0.08);transition:background 0.18s,box-shadow 0.18s;border:none;">Limpiar</button>
  </div>

  <script>
    // Funcionalidad avanzada para Nombre igual que Código
    const nombreInput = document.querySelector('input[name="nombre"]');
    const areaInput = document.getElementById('areaInput');
    // Validación estricta y autocompletar para Nombre
    nombreInput.addEventListener('input', function(e) {
      const nombre = nombreInput.value.trim();
      if (listaNombres.includes(nombre)) {
        document.getElementById('mensaje').textContent = '';
        // Pasar automáticamente al campo Área si el nombre es válido
        setTimeout(() => areaInput.focus(), 0);
      } else {
        document.getElementById('mensaje').textContent = 'Ingrese un nombre válido de la lista.';
      }
    });
    nombreInput.addEventListener('keydown', function(e) {
      if ((e.key === 'Tab' || e.key === 'Enter') && !listaNombres.includes(nombreInput.value.trim())) {
        e.preventDefault();
        document.getElementById('mensaje').textContent = 'Ingrese un nombre válido de la lista.';
        nombreInput.focus();
      }
    });
    nombreInput.addEventListener('blur', function(e) {
      if (!listaNombres.includes(nombreInput.value.trim())) {
        document.getElementById('mensaje').textContent = 'Ingrese un nombre válido de la lista.';
        // Evitar bucle de foco si el usuario va a Área
        setTimeout(() => {
          const active = document.activeElement;
          if (active !== areaInput) {
            nombreInput.focus();
          }
        }, 0);
      } else {
        document.getElementById('mensaje').textContent = '';
      }
    });

    // Lista de nombres para autocompletar
    const listaNombres = [
      "Jose Rodelo",
      "Humberto Huerta",
      "Christian Molina",
      "Fernando Moreno",
      "Orlando Ibarra",
      "Samai Acosta",
      "Jorge Barrón",
      "Daniel Hernández",
      "Luis López",
      "Francisco López",
      "Gabriel Martinez",
      "David Oliva",
      "Jose Jasso",
      "Francisco Mendoza",
      "Heriberto Hernández",
      "Edson Gonzalez",
      "Edgar López",
      "Misael Avilés",
      "Jorge Tirado",
      "Misael Palafox",
      "Rodolfo Villarreal",
      "Esto es una prueba"
    ];
    const datalistNombres = document.getElementById('listaNombres');
    listaNombres.forEach(nombre => {
      const option = document.createElement('option');
      option.value = nombre;
      datalistNombres.appendChild(option);
    });

    // Lista de áreas para autocompletar
    const listaAreas = [
      "Oxígeno medicinal",
      "Argón",
      "Nitrógeno",
      "Oxígeno industrial",
      "Hidrógeno",
      "Gases especiales",
      "Co2",
      "Dewars"
    ];
    const datalistAreas = document.getElementById('listaAreas');
    listaAreas.forEach(area => {
      const option = document.createElement('option');
      option.value = area;
      datalistAreas.appendChild(option);
    });

    // Funcionalidad avanzada para Área igual que Código
    areaInput.addEventListener('input', function(e) {
      const area = areaInput.value.trim();
      if (listaAreas.includes(area)) {
        document.getElementById('mensaje').textContent = '';
        // Pasar automáticamente al campo Código si el área es válida
        setTimeout(() => codigoInput.focus(), 0);
      } else {
        document.getElementById('mensaje').textContent = 'Ingrese un área válida de la lista.';
      }
    });
    areaInput.addEventListener('keydown', function(e) {
      if ((e.key === 'Tab' || e.key === 'Enter') && !listaAreas.includes(areaInput.value.trim())) {
        e.preventDefault();
        document.getElementById('mensaje').textContent = 'Ingrese un área válida de la lista.';
        areaInput.focus();
      }
    });
    areaInput.addEventListener('blur', function(e) {
      if (!listaAreas.includes(areaInput.value.trim())) {
        document.getElementById('mensaje').textContent = 'Ingrese un área válida de la lista.';
        setTimeout(() => areaInput.focus(), 0);
      } else {
        document.getElementById('mensaje').textContent = '';
      }
    });

    // Nueva lista de códigos a descripciones
    const codigoDescripcion = {
      "122": "ARGON LIQUIDO EN DEWARS",
      "130": "M3. OXIGENO LIQUIDO DEWARE",
      "131": "M3. NITROGENO LIQUIDO DEWARE",
      "133": "NITROGENO LIQUIDO DEWAR 22 PSI",
      "138": "M3 NITROGENO DEWAR ABIERTO",
      "206": "M3. OXIGENO MEDICIN.LIQUID.THERMO DW",
      "239": "NITR?GENO INDUSTRIAL MEGADEWAR 230L",
      "246": "NITROGENO SPARKLASER DEWAR 230L (350PSI)",
      "247": "NITROGENO LIQ FRESCOPACK DEWAR 230LTS (22 PSI)",
      "270": "NITROGENO IND. LIQUIDO MINIBULK 230 LTS.",
      "385": "CO2 INDUSTRIAL LIQUIDO DEWAR 230LTS (350PSI)",
      "386": "NITROGENO 4.7 LIQ DEWAR 230LTS (350PSI)",
      "387": "NITROGENO LIQUIDO FRESCOPACK DEWAR 230LTS (350PSI)",
      "388": "NITROGENO LIQUIDO INDUSTRIAL DEWAR 230LTS (350PSI)",
      "389": "OXIGENO LIQUIDO SPARK LASER ASISTENCIA DEWAR 230LT",
      "396": "ARGON INDUSTRIAL LIQUIDO DEWAR 230LTS (350PSI)",
      "397": "OXIGENO INDUSTRIAL LIQUIDO  DEWAR 230LTS (350PSI)",
      "398": "OXIGENO MEDICINAL LIQUIDO DEWAR 230 LTS (350PSI)",
      "433": "BIOXIDO DE CARBONO CON SIFON",
      "443": "CO2 USP",
      "445": "BIOXIDO DE CARBONO GASEOSO GRADO USP CIL C/SIFON",
      "446": "CO2 (BIOXIDO DE CARBONO) CON SIFON 9 KGS",
      "449": "CO2 FG LIQUIDO DEWAR 230 LTS ( 350 PSI )",
      "486": "NITROGENO LIQUIDO ULTRA ALTA PUREZA DEWAR 230 LTS",
      "601": "OXIGENO MEDICINAL USP E",
      "602": "NITROGENO GRADO MEDICINALLIQUIDO",
      "603": "NITROGENO GRADO MEDICINAL GASEOSO",
      "604": "CARGA DE NITROGENO GRADO MEDICINAL LIQUIDO PORTATI",
      "605": "BIOXIDO DE CARBONO USP (CO2-USP)",
      "614": "CARGA DE OXIGENO GASEOSO INDUSTRIAL PORTATIL",
      "625": "NITROGENO GRADO MEDICINAL LIQUIDO",
      "630": "CARGA DE CO2 USP BT-20 2.0 KG",
      "631": "CARGA DE CO2 USP BT-40",
      "632": "CARGA DE CO2 USP BT-80",
      "640": "CARGA DE CO2 USP D 1 KGS",
      "641": "CO2 USP E VALVULA YUGO 2.0 KG",
      "651": "CARGA DE OXIGENO MEDICINAL USP BT-20",
      "652": "CARGA DE OXIGENO MEDICINAL USP BT-40",
      "653": "CARGA DE OXIGENO MEDICINAL USP BT-80",
      "654": "CARGA DE OXIGENO MEDICINAL USP M",
      "655": "CARGA DE OXIGENO MEDICINAL USP E TODO EN UNO",
      "658": "OXIGENO MEDICINAL USP \" E \"  DE 0.682 M3",
      "659": "OXIGENO MEDICINAL USP \" M \" DE 3.45 M3",
      "661": "CARGA DE NITROGENO GRADO MEDICINAL BT-20",
      "663": "CARGA DE NITROGENO GRADO MEDICINAL BT-80",
      "672": "NITROGENO GRADO MEDICINAL LIQUIDO THERMO PORT 4 LT",
      "675": "NITROGENO MEDICINAL L?QUIDO DEWAR 230 LTS (22 PSI)",
      "701": "CARGA DE OXIGENO 1 M3",
      "702": "CARGA DE OXIGENO 1.5 M3",
      "703": "CARGA DE OXIGENO 2.0 M3",
      "704": "CARGA DE OXIGENO INDUSTRIAL DE 3 M3",
      "710": "CARGA DE NITROGENO 1 M3",
      "711": "CARGA DE NITROGENO 1.5 M3",
      "712": "CARGA DE NITROGENO 2.0 M3",
      "713": "CARGA DE NITROGENO INDUSTRIAL DE 3 M3",
      "740": "CARGA DE ARGON 1 M3",
      "741": "CARGA DE ARGON 2 M3",
      "742": "CARGA DE ARGON 3 M3",
      "750": "CARGA DE HIDROGENO 1 M3",
      "760": "CARGA DE CO2 1 KGS.",
      "761": "CARGA DE CO2 2 KGS.",
      "762": "CARGA DE CO2 4 KGS.",
      "766": "CILINDRO CO2 KOF 20 L.",
      "801": "RECARGA DE OXIGENO MEDICINAL DE 247 LTS.",
      "802": "RECARGA DE OXIGENO MEDICINAL DE 415 LTS.",
      "803": "RECARGA DE OXIGENO MEDICINAL DE 682 LTS.",
      "805": "RECARGA DE OXIGENO MEDICINAL DE 1725 LTS.",
      "809": "RECARGA DE OXIGENO MEDICINAL DE 3450 LTS.",
      "811": "CARGA DE RECARGA DE OXIGENO INFRALIFE .172 LTS",
      "32005": "AIRE CERO/UAP",
      "32015": "AIRE EXTRA SECO",
      "32016": "CARGA DE AIRE EXTRASECO (C.MIN.)",
      "32024": "INFRA AR MIXX ( ARGON GRADO SOLDADURA 6 M3 )",
      "32025": "INFRA AR MIXX ( ARGON GRADO SOLDADURA )",
      "32026": "CARGA DE ARGON ULTRA ALTA PUREZA (CA.MIN.)",
      "32029": "ARGON ALTA PUREZA",
      "32030": "ARGON 4.7 LIQ  DEWAR",
      "32031": "AR MIXX ARGON GRADO SOLDADURA",
      "32032": "ARGON 4.8 10 M3 A",
      "32033": "ARGON ULTRA ALTA PUREZA 10 M3",
      "32035": "ARGON 4.8 A",
      "32040": "ARGON ULTRA ALTA PUREZA",
      "32045": "ARGON ULTRA ALTA PUREZA LIQUIDO",
      "32046": "CARGA DE ARGON 4.7 (C.M.)",
      "32063": "CARGA DE CARBOGENO 20%",
      "32065": "CARGA DE CARBOGENO 5%",
      "32069": "HELIO INDUSTRIAL 8.5 MTS",
      "32070": "CARGA DE INFRA FRESCO PACK",
      "32071": "HELIO INDUSTRIAL 3.5M3",
      "32072": "HELIO INDUSTRIAL 6M3",
      "32073": "HELIO INDUSTRIAL 8.5M3",
      "32075": "HELIO GLOBERO 6M",
      "32076": "HELIO GLOBERO BT-80 2M",
      "32077": "HELIO GLOBERO DE 8.5M",
      "32079": "HELIO 4.7 6M3",
      "32080": "HELIO 4.7 A",
      "32081": "CARGA DE HELIO 4.7 (C.M.)",
      "32090": "HELIO 4.8 A",
      "32091": "CARGA DE HELIO 4.8 (C.M.)",
      "32093": "HELIO UAP 4.1M3",
      "32094": "HELIO UAP 6M3",
      "32095": "HELIO ULTRA ALTA PUREZA",
      "32096": "CARGA DE HELIO UAP (C.M.)",
      "32098": "HELIO 4.8 6.0 M3 B",
      "32099": "HIDROGENO ALTA PUREZA",
      "32100": "HIDROGENO 4.8 B",
      "32101": "CARGA DE HIDROGENO 4.8 (C.M.)",
      "32105": "HIDROGENO EXTRA SECO",
      "32110": "CARGA DE HIDROGENO CERO/ULTRA ALTA PUREZA",
      "32111": "CARGA DE HIDROGENO CERO UAP CARGA MINIMA",
      "32120": "NITROGENO 4.7 A",
      "32121": "CARGA DE N2 AP CARGA MINIMA",
      "32123": "NITROGENO AP 6.0 M3",
      "32125": "NITROGENO 4.7 LIQ  DEWAR",
      "32129": "CARGA DE NITROGENO 4.7 A",
      "32135": "NITROGENO 4.8  A",
      "32136": "CARGA DE N2 4.8 (C.M.)",
      "32140": "NITROGENO 4.8 LIQ DEWAR",
      "32145": "NITROGENO ULTRA ALTA PUREZA",
      "32146": "CARGA DE N2 UAP (CA.MIN.)",
      "32148": "NITROGENO UAP 6.0 M3",
      "32150": "NITROGENO ULTRA ALTA PUREZA LIQUIDO",
      "32151": "FRESCOPACK LIQUIDO",
      "32152": "CARGA DE NITROGENO LIQUIDO GRADO ALIMENTICIO",
      "32153": "FRESCOPACK LIQUIDO TANQUE THERMO",
      "32159": "OXIGENO CORTE LASER",
      "32160": "OXIGENO EXTRA SECO",
      "32170": "OXIGENO RESPIRABLE P/AVIACION",
      "33040": "CARGA DE MEZCLA AR 25%/HE 75%",
      "33041": "CARGA DE MEZCLA AR 60% HE 40%",
      "33042": "CARGA DE MEZCLA AR 75%/HE 25%",
      "33043": "CARGA DE MEZCLA 70% AR/HE 30%",
      "33055": "CARGA DE MEZCLA AR 90%/CO2 10%",
      "33060": "CARGA DE MEZCLA AR 65%/H2 35%",
      "33061": "CARGA DE MEZCLA AR 90%/H2 10%",
      "33062": "CARGA DE MEZCLA AR 93%/H2 7%",
      "33063": "CARGA DE MEZCLA AR 96%/H2 4%",
      "33064": "CARGA DE MEZCLA AR 98%/H2 2%",
      "33065": "CARGA DE H2 1% / AR BAL.",
      "33070": "CARGA DE MEZCLA AR 7.5%/CO2 2.5%/HE 90%",
      "33072": "CARGA DE H2 5% / AR BAL.",
      "33148": "CARGA DE COOKING PACK III (MEZCLA CO2 35%/N2 BAL.)",
      "33194": "CARGA DE COOKING PACK II (MEZCLA CO2 20%/N2  BAL.)",
      "33195": "CARGA DE INFRA COOKING PACK",
      "33196": "CARGA DE COOKING PACK IV",
      "33197": "CARGA DE MEZCLA CO2 5%/N2 BAL",
      "33198": "CARGA DE INFRA PANI PACK",
      "33221": "MEZCLA LASER ESP.(CO2 5%/HELIO 40%/N2 55%BAL.)",
      "33249": "CARGA DE O2 8% / N2 BAL. (CA. MIN.)",
      "33261": "CARGA DE H2 1% / N2 BAL.",
      "33277": "CARGA DE H2 2% / N2 BAL.",
      "33278": "CARGA DE H2 10% / N2 BAL.",
      "33281": "CARGA DE MEZCLA H2 20%/N2 80%",
      "33284": "CARGA DE MEZCLA H2 4%/N2 96%",
      "33285": "CARGA DE MEZCLA H2 40%/N2 60%",
      "33286": "CARGA DE MEZCLA H2 5%/N2 95%",
      "33287": "CARGA DE MEZCLA H2 50%/N2 50%",
      "33290": "CARGA DE H2 1%/N2 99%",
      "33299": "CARGA DE N2 20% / CO2 BAL.",
      "33310": "CARGA DE MEZCLA HE 10%/N2 90%",
      "33331": "CARGA DE MEZCLA N2 79%/O2 21%",
      "33397": "CARGA DE COUGAR 77-TM",
      "33420": "CARGA DE MEZCLA PARA SOLDAR C-1",
      "33421": "CARGA DE WELDER C-1 (CA.MIN.)",
      "33425": "CARGA DE MEZCLA PARA SOLDAR C-2",
      "33426": "CARGA DE WELDER C-3",
      "33435": "CARGA DE WELDER C-5",
      "33445": "CARGA DE MEZCLA PARA SOLDAR C-7",
      "33455": "CARGA DE WELDER X-1",
      "33460": "CARGA DE DIVERTIGLOBO",
      "33500": "CARGA DE MEZCLAS VARIAS PARA PRUEBAS",
      "34045": "CARGA DE HELIO CROMATOGRAFICO APCI",
      "41008": "CARGA DE N2 30%/HE BAL.",
      "41155": "CARGA DE H2 10%/N2 BAL.",
      "41166": "CARGA DE AR 50%/HE 50%",
      "41231": "CARGA DE N2 ULTRA ALTA PUREZA (CA.MIN.)",
      "41276": "NITROGENO LIQ. DEWAR ALTA PRESION",
      "41277": "CARGA DE HE 30%/N2 BAL.",
      "41316": "CARGA DE INFRA -FERRO G (10 M3)",
      "41317": "CARGA DE INFRA - FERRO D (9.5 M3)",
      "41319": "CARGA DE INFRA -INOXX TAG (9.5 M3)",
      "41320": "CARGA DE INFRA MIXX 200/25 (10.5 M3)",
      "41321": "CARGA DE INFRA MIXX 200/20 (10 M3)",
      "41322": "CARGA DE INFRA MIXX 200/O5 (9.5 M3)",
      "41323": "CARGA DE INFRA MIXX 200/2 (9.5 M3)",
      "41324": "CARGA DE INFRA MIXX 200/O2 (9.5 M3)",
      "41325": "CARGA DE INFRA MIXX 200/15 (10 M3)",
      "41326": "CARGA DE INFRA MIXX 200/8 (9.5 M3)",
      "41327": "CARGA DE INFRA MIXX 200/10 (10 M3)",
      "41328": "CARGA DE INFRA ALUMIXX 8.5 M3",
      "41329": "CARGA DE INFRA MIXX 200/5 (9.5 M3)",
      "41330": "CARGA DE INFRA MIXX 72 C (9.5 M3)",
      "41335": "CARGA DE INFRA INNOX TAG X-1 (9.0 M3)",
      "41336": "CARGA DE INFRA MIXX 200/18 (10 M3)",
      "41674": "CARGA DE OXIGENO EXTRA SECO (CA.MIN.)",
      "41681": "HE 20% / AR. BAL.",
      "41784": "CARGA DE HE 40%/N2 BAL.",
      "41855": "CARGA DE H2 15%/N2 BAL.",
      "41975": "CARGA DE N2 40%/HE BAL.",
      "41981": "CARGA DE HE 25%/N2 BAL.",
      "50032": "CARGA DE MP H2 40%/N2 BAL.",
      "50130": "HE 50% / N2 BAL",
      "50469": "CARGA DE H2 5%/N2 BAL. (CARGA MINIMA)",
      "50493": "CARGA DE CO2 25%/AR BAL",
      "50548": "CARGA DE COOKING PACK (CARG MINIMA)",
      "50550": "CARGA DE PANIPACK (CARGA MINIMA)",
      "50568": "CARGA DE CO2 EXTRASECO DEWAR",
      "50578": "CARGA DE FRESCOPACK ( CARGA MINIMA)",
      "50685": "CARGA DE CO2 25%/AR BAL.(C.M.)",
      "50709": "CARGA DE MEZCLA ESPECIAL 20%/HE 80%/N2",
      "50716": "BIOXIDO DE CARBONO FG 169 KG",
      "50792": "CARGA DE H2 40% NITROGENO BAL 6.5 M3",
      "50967": "CARGA DE CO2 FG  9KG",
      "51052": "CARGA DE INFRA MIXX 200/25 6M3",
      "51132": "CARGA DE SPARK LASER O2 ASISTENCIA CL",
      "51157": "CARGA DE HE 50%/N2 BAL. (A)",
      "51304": "SPARK LASER N2 ASISTENCIA DW",
      "51306": "SPARK LASER O2 ASISTENCIA DW",
      "51321": "SPARK LASER N2 ASISTENCIA CL",
      "51339": "CARGA DE SPARK LASER HE PROTEC",
      "51340": "CARGA DE SPARK LASER AR PROTEC",
      "51376": "SPARK LASER HE RESONADOR VPR",
      "51377": "SPARK LASER N2 RESONADOR VPR",
      "51384": "CARGA DE CO2 FG C.M.",
      "51400": "SPARK LASER O2 ASISTENCIA CL-M",
      "51409": "SPARK LASER HE PROTECT-M",
      "51410": "SPARK LASER AR PRTOTECT-M",
      "51426": "ARGON 4.8 VPR A",
      "51552": "HELIO UAP HELIX BROOKS",
      "51580": "CARGA DE CO2 3%/AR 97% BAL.",
      "51581": "CARGA DE CO2 BEBIDAS",
      "51624": "CARGA DE ARGON (AR)ICP 99.999%* A",
      "51628": "HELIO UAP PARA ARRASTRE",
      "51662": "CARGA DE CO2 ICEE",
      "51759": "CO2 GRADO ALIMENTICIO CON SIFON 9 KG",
      "51797": "BIOXIDO DE CARBONO 45.36KG C/PH",
      "51802": "CO2 FG 20 KGS",
      "51807": "CO2 EXTRA SECO C/SIFON 25 KG",
      "51861": "COOKING PACK 10",
      "51872": "MESP H2 5%/N2 BAL.",
      "51889": "H2 30%/N2 BAL. CM",
      "51896": "H2  5% / N2 BAL",
      "51928": "MEZCLA 98% ARGON/2% NITROGENO",
      "51954": "30% HELIO / N2 BAL.",
      "51973": "HE 10%, N2 BAL. (CYL  A)",
      "52014": "OXIGENO EXTRA SECO CILINDRO A",
      "52023": "CO2 30%, N2 BAL.",
      "52100": "INFRA AEI ARGON FL",
      "52128": "INFRA GALVAMIXX",
      "52146": "HE ULTRA ALTA PUREZA PLUS",
      "52154": "HE ULTRA ALTA PUREZA PLUS",
      "52176": "CO2 50% / AR BAL",
      "52291": "CO2 15% / N2 BAL",
      "52423": "NITROGENO 4.7 30AL",
      "52584": "HE 20% / N2 BAL",
      "52652": "INFRA ALUMIXX D",
      "52680": "AR MIXX PORTATIL",
      "52708": "ARGON 4.7 A",
      "52709": "ARGON 4.7 A",
      "52729": "INFRA AR MIXX DEWAR",
      "52764": "INFRA MIXX 200/25 PORTATIL",
      "52767": "SPARK LASER ARGON PROTECT-M 10 M3",
      "52787": "CARBO MIXX ( CO2 GRADO SOLDADURA )",
      "52823": "INFRA CARBO MIXX DW ( CO2 LIQUIDO GRADO SOLDADURA)",
      "52854": "CARGA DE SPARK LASER AR PROTEC (10M3)",
      "52855": "CARGA DE ARGON (AR)ICP 99.999%* A (10M3)",
      "52958": "HELIO 4.7 9M3",
      "52959": "HELIO 4.8 9M3",
      "52960": "HELIO ULTRA ALTA PUREZA 9M3",
      "52961": "SPARK LASER HE RESONADOR VPR 9M3",
      "52962": "SPARK LASER HE PROTECT-M 9M3",
      "52963": "HELIO UAP HELIX BROOKS 9M3",
      "52964": "HELIO UAP PARA ARRASTRE 9M3",
      "52965": "HE ULTRA ALTA PUREZA PLUS 9M3",
      "52981": "R744 CIL 25 KG C/SIFON",
      "53012": "H2 3% / HE BAL",
      "53021": "ARGON INDUSTRIAL EN RACK DE 12 CILINDROS DE 9.5 MT",
      "53022": "ARGON ARMIXX EN RACK DE 12 CILINDROS DE 10 MTS",
      "53023": "CO2 50% / AR BAL EN RACK DE 12 CILINDROS DE 5.5 MT",
      "53024": "HELIO 4.7 RACK 12 CILINDROS DE 9 M3",
      "53025": "HIDROGENO EXTRASECO EN RACK DE 12 CILINDROS DE 6 M",
      "53026": "HIDROGENO INDUSTRIAL EN RACK DE 12 CILINDROS DE 7.",
      "53027": "INFRA MIXX 200/25 EN RACK DE 12 CILINDROS DE 10.5",
      "53028": "NITROGENO 4.7 RACK 12 CILINDROS DE 9",
      "53029": "NITROGENO INDUSTRIAL EN RACK DE 12 CILINDROS DE 9",
      "53030": "SPARK LASER ARGON PROTECT-M EN RACK DE 12 CILINDRO",
      "53031": "SPARK LASER HE PROTECT-M EN RACK DE 12 CILINDROS D",
      "53032": "SPARK LASER N2 ASISTENCIA CL EN RACK DE 12 CILINDR",
      "53033": "SPARK LASER O2 ASISTENCIA PACK EN RACK DE 12 CILIN",
      "53078": "INFRA INOXX TAG X-1 EN RACK DE 12 CIL DE 9.0 M3",
      "53085": "HELIO INDUSTRIAL RACK DE 12 CIL 8.5M3",
      "53089": "MEZCLA H2 5% / N2 95% RACK DE 12 CILINDROS 8.5 MTS",
      "53090": "H2 rack extra seco",
      "53091": "HIDROGENO 4.8 RACK 12 CILINDROS 6 M3",
      "53092": "NITROGENO ULTRA ALTA PUREZA  RACK 12 CILINDRO 9 M3",
      "53093": "OXIGENO INDUSTRIAL EN RACK  12 CILINDROS DE 9.5 M3",
      "53094": "INFRA MIXX 200/8 EN RACK DE 12 CILINDROS DE 9.5 MT",
      "53095": "INFRA FERRO D EN RACK DE 12 CILINDROS DE 9.5 MTS",
      "53096": "ARGON ULTRA ALTA PUREZA EN RACK 12 CILINDROS 10 MT",
      "53097": "INFRA MIXX 200/10 EN RACK DE 12 CILINDROS 10 MTS",
      "53098": "INFRA MIXX 200/18 EN RACK DE 12 CILINDROS  10 MTS",
      "53099": "INFRA MIXX 200/5 EN RACK DE 12 CILINDROS 9.5 MTS",
      "53100": "INFRA MIXX 200/O2 EN RACK DE 12 CILINDROS 9.5 MTS",
      "53103": "HELIO ULTRA ALTA PUREZA RACK 12 CILINDROS 9 M3",
      "53116": "HELIO PREMIER",
      "53123": "MEZCLA HE 30 % /N2 BAL EN RACK 12 CILINDROS 8 M3",
      "53151": "INFRA MIXX 200/20 EN RACK DE 12 CILINDROS DE 10 M3",
      "53179": "MEZCLA DE H2 3% /  HE BAL EN RACK DE 12 CIL 8.5 M3",
      "53184": "MEZCLA N2 40% / HE BAL EN RACK 12 CIL DE 6M3",
      "53442": "HELIO PREMIER 6M3",
      "53589": "MEZCLA HELIO 50% BALANCE NITR?GENO EN RACK DE 12 C",
      "54005": "CO2 10% / N2 BAL",
      "54033": "CO2 3% / N2 BAL",
      "54034": "CO2 6% / N2 BAL",
      "101030": "OXIGENO INDUSTRIAL 3.0 MTS",
      "101060": "OXIGENO INDUSTRIAL 6 MTS",
      "101095": "OXIGENO INDUSTRIAL 9.5",
      "101113": "OXIGENO INDUSTRIAL 9.5 MTS",
      "101114": "OXIGENO INDUSTRIAL 6 M3",
      "101160": "OXIGENO INDUSTRIAL 6 M3 VALVULA CGA",
      "101195": "OXIGENO INDUSTRIAL 9.5 M3 VALVULA CGA",
      "103060": "NITROGENO GAS 6 MTS VAL CGA 580",
      "103090": "NITROGENO GAS 9 MTS VAL CGA 580",
      "103112": "NITROGENO GAS 9 MTS.",
      "104060": "HIDROGENO INDUSTRIAL 6 M3",
      "104075": "HIDROGENO INDUSTRIAL 7.5 M3",
      "105060": "ARGON 6 MTS VAL CGA 580",
      "105090": "ARGON PURO 9 MTS",
      "105095": "ARGON 9.5 MTS VAL CGA 580",
      "201010": "OXIGENO MEDICINAL EN CIL. MCA INFRA 10 MTS",
      "201030": "OXIGENO MEDICINAL EN CIL MCA INFRA 3 MTS",
      "201060": "OXIGENO MEDICINAL EN CIL MCA INFRA 6 MTS",
      "201085": "OXIGENO MEDICINAL EN CIL MCA INFRA 8.5 MTS",
      "201095": "OXIGENO MEDICINAL EN CIL MCA INFRA 9.5 MTS",
      "431008": "CO2 INDUSTRIAL 8 KGS",
      "431009": "CO2 INDUSTRIAL 9 KGS",
      "431010": "CO2 10 KG",
      "431012": "CO2 INDUSTRIAL 12 KGS",
      "431015": "CO2 INDUSTRIAL 15 KGS",
      "431016": "CO2 INDUSTRIAL 16 KGS",
      "431020": "CO2 INDUSTRIAL 20 KG",
      "431022": "CO2 INDUSTRIAL 22 KGS",
      "431025": "CO2 INDUSTRIAL 25 KGS",
      "431030": "CO2 INDUSTRIAL 30 KGS",
      "431045": "CO2 INDUSTRIAL 45 KG",
      "432169": "CO2 DEWAR 169 KGS",
      "3000660": "HELIO GRADO 6.0 9 M3 A",
      "3000668": "Mezcla 21% He Balance N2 Cilindro tipo A",
      "3000694": "MEZCLA 5% H2 BALANCE N2 EN RACK CILINDROS DE 6 M3",
      "3000844": "SIX SPARK LASER NITROGENO",
      "3001309": "INFRA Ar MIXX PLUS",
      "3001310": "INFRA MIXX PLUS 200/20",
      "3001313": "INFRA MIX 200/O5 RACK 12 CIL,(114 M3)",
      "3001384": "INFRA ALUMIXX 25 RACK",
      "3001443": "H2 UAP/CERO EN RACK 12 CILINDROS DE  6 M3",
      "50656": "CO2 FG",
      "3001554": "H2 UAP/CERO EN RACK 12 CILINDROS DE  7.5 M3"
    };
    const registros = [];
    let editandoIndice = null;
    // Poblar el datalist de códigos
    // const areaInput = document.getElementById('areaInput'); // Eliminada para evitar redeclaración
    const codigoInput = document.getElementById('codigoInput');
    const productoInput = document.getElementById('productoInput');
    const cilindrosInput = document.querySelector('input[name="cilindros"]');
    const datalist = document.getElementById('listaCodigos');
    Object.entries(codigoDescripcion).forEach(([codigo, descripcion]) => {
      const option = document.createElement('option');
      option.value = codigo;
      option.label = `${codigo} - ${descripcion}`;
      datalist.appendChild(option);
    });

    // Habilitar/deshabilitar campos según área válida
    areaInput.addEventListener('input', function() {
      if (listaAreas.includes(this.value.trim())) {
        codigoInput.disabled = false;
      } else {
        codigoInput.value = '';
        productoInput.value = '';
        cilindrosInput.value = '';
        codigoInput.disabled = true;
        productoInput.disabled = true;
        cilindrosInput.disabled = true;
      }
    });

    // Autocompletar producto y habilitar campos según código válido
    codigoInput.addEventListener('input', function(e) {
      const codigo = this.value.trim();
      if (codigoDescripcion[codigo]) {
        productoInput.value = codigoDescripcion[codigo];
        productoInput.disabled = false;
        cilindrosInput.disabled = false;
        // Mover el foco al campo de cilindros automáticamente
        setTimeout(() => {
          cilindrosInput.focus();
        }, 0);
      } else {
        productoInput.value = '';
        productoInput.disabled = true;
        cilindrosInput.value = '';
        cilindrosInput.disabled = true;
      }
    });
document.getElementById('registroForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const form = e.target;
  // Validar nombre
  if (!listaNombres.includes(form.nombre.value.trim())) {
    document.getElementById('mensaje').textContent = 'Ingrese un nombre válido de la lista.';
    form.nombre.focus();
    return;
  }
  // Validar área
  if (!listaAreas.includes(form.area.value.trim())) {
    document.getElementById('mensaje').textContent = 'Ingrese un área válida de la lista.';
    form.area.focus();
    return;
  }
  const area = form.area.value.trim();
  const codigo = form.codigo.value.trim();
  // Validar código
  if (!codigoDescripcion[codigo]) {
    document.getElementById('mensaje').textContent = 'Ingrese un código válido.';
    form.codigo.focus();
    return;
  }
  const now = new Date();
  const fecha = now.toLocaleDateString();
  const hora = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });
  const data = {
    fecha: fecha,
    hora: hora,
    nombre: form.nombre.value,
    area: area,
    codigo: codigo,
    producto: form.producto.value,
    cilindros: form.cilindros.value
  };
  if (editandoIndice !== null) {
    // Actualizar registro existente
    registros[editandoIndice] = data;
    // Actualizar la tabla (ID, Código, Producto, Cilindros)
    const tbody = document.querySelector('#tablaRegistros tbody');
    const fila = tbody.children[editandoIndice];
    fila.children[0].textContent = editandoIndice + 1; // ID
    fila.children[1].textContent = data.codigo;
    fila.children[2].textContent = data.producto;
    fila.children[3].textContent = data.cilindros;
    document.getElementById('mensaje').textContent = 'Registro actualizado.';
    document.querySelector('button[type="submit"]').textContent = 'Registrar';
    editandoIndice = null;
  } else {
    // Solo agregar a la tabla local y al array
    registros.push(data);
    agregarFilaTabla(data);
    document.getElementById('mensaje').textContent = 'Registro guardado localmente.';
    // El mensaje de agradecimiento solo aparecerá después de enviar los registros
    document.getElementById('agradecimiento').textContent = '';
  }
  form.codigo.value = '';
  form.cilindros.value = '';
  form.producto.value = '';
  form.codigo.focus();
});

    document.getElementById('btnEnviar').addEventListener('click', function() {
      if (registros.length === 0) {
        document.getElementById('mensaje').textContent = 'No hay registros para enviar.';
        return;
      }
      const url1 = 'https://script.google.com/macros/s/AKfycbznrApZ2-RHLZ_1Sx5jaA0yJjQL8FdXSCaLdDEubo_7hocvB5CGcNHnzocLN-E_o_GhUQ/exec';
      const url2 = 'https://script.google.com/macros/s/AKfycbw-x_4ybQCSbxxboO4mkZztuUY3wp035ZYL_I56v6tbC2LnCw8lojACyEBlsZAWr7lqNA/exec';
      let enviados = 0;
      async function enviarConRetraso() {
        // Usar el nombre del primer registro para el mensaje de agradecimiento
        const nombreParaAgradecimiento = (registros.length > 0 && registros[0].nombre) ? registros[0].nombre : 'usuario';
        for (let i = 0; i < registros.length; i++) {
          let registroEnviar = { ...registros[i] };
          if (!registroEnviar.fecha || !registroEnviar.hora) {
            const now = new Date();
            registroEnviar.fecha = now.toLocaleDateString();
            registroEnviar.hora = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });
          }
          // Solo enviar la fecha, descartar la hora
          delete registroEnviar.hora;
          // Enviar al primer archivo (con ID)
          let registroConID = { ...registroEnviar, id: i + 1 };
          fetch(url1, {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(registroConID)
          });
          // Enviar al segundo archivo (con ID)
          fetch(url2, {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(registroConID)
          });
          enviados++;
          document.getElementById('mensaje').textContent = 'Enviando registro ' + enviados + ' de ' + registros.length + '...';
          await new Promise(res => setTimeout(res, 1000));
        }
        document.getElementById('mensaje').textContent = 'Registros enviados (' + enviados + ').';
        // Mostrar mensaje de agradecimiento después de enviar usando el nombre del primer registro
        document.getElementById('agradecimiento').textContent = '¡Gracias, ' + nombreParaAgradecimiento + ', por tu colaboración!';
        // Limpiar registros locales y la tabla tras el envío
        registros.length = 0;
        const tbody = document.querySelector('#tablaRegistros tbody');
        tbody.innerHTML = '';
        // Limpiar campos Área, Código, Producto y Cilindros
        const form = document.getElementById('registroForm');
        form.area.value = '';
        form.codigo.value = '';
        form.producto.value = '';
        form.cilindros.value = '';
        // Posicionar el cursor en el campo Nombre para evitar bucles de validación
        setTimeout(() => form.nombre.focus(), 0);
      }
      enviarConRetraso();
    });

    document.getElementById('btnDescargar').addEventListener('click', function() {
      if (registros.length === 0) {
        document.getElementById('mensaje').textContent = 'No hay registros para descargar.';
        return;
      }
      // Convertir registros a CSV usando coma como separador y agregando BOM UTF-8
      const csvRows = [];
      // Encabezados
      csvRows.push(['ID', 'Fecha', 'Nombre', 'Área', 'Código', 'Producto', 'Cilindros'].join(','));
      // Datos
      registros.forEach((reg, index) => {
        csvRows.push([
          index + 1,
          reg.fecha,
          reg.nombre,
          reg.area,
          reg.codigo,
          reg.producto,
          reg.cilindros
        ].map(val => typeof val === 'string' ? '"' + val.replace(/"/g, '""') + '"' : val).join(','));
      });
      // Agregar BOM UTF-8 para que Excel reconozca la codificación y los acentos
      const BOM = '\uFEFF';
      const csvString = BOM + csvRows.join('\r\n');
      const blob = new Blob([csvString], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.setAttribute('href', url);
      a.setAttribute('download', 'registros_inventario.csv');
      a.style.visibility = 'hidden';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      document.getElementById('mensaje').textContent = 'Registros descargados como CSV.';
    });

    document.getElementById('btnLimpiar').addEventListener('click', function() {
      const form = document.getElementById('registroForm');
      // Limpiar solo los campos del formulario
      Array.from(form.elements).forEach(el => {
        if (el.tagName === 'INPUT' && (el.type === 'text' || el.type === 'number')) {
          el.value = '';
        }
      });
      // Borrar mensaje de agradecimiento
      document.getElementById('agradecimiento').textContent = '';
      // Posicionar el foco en el campo nombre
      setTimeout(() => form.nombre.focus(), 0);
    });

function agregarFilaTabla(data) {
  const tbody = document.querySelector('#tablaRegistros tbody');
  const fila = document.createElement('tr');
  const id = tbody.children.length + 1;
  fila.innerHTML = `
    <td style="padding:6px 4px;border-bottom:1px solid #f0f0f0;">${id}</td>
    <td style="padding:6px 4px;border-bottom:1px solid #f0f0f0;">${data.codigo}</td>
    <td style="padding:6px 4px;border-bottom:1px solid #f0f0f0;">${data.producto}</td>
    <td style="padding:6px 4px;border-bottom:1px solid #f0f0f0;">${data.cilindros}</td>
    <td style="padding:6px 2px;border-bottom:1px solid #f0f0f0; text-align:center; white-space:nowrap;">
      <button type="button" class="btnEditar" title="Editar" style="background:#f59e42;color:#fff;border:none;padding:2px 7px;font-size:0.92em;border-radius:3px;cursor:pointer;margin-right:3px;">✏️</button>
      <button type="button" class="btnEliminar" title="Eliminar" style="background:#ef4444;color:#fff;border:none;padding:2px 7px;font-size:0.92em;border-radius:3px;cursor:pointer;">🗑️</button>
    </td>
  `;
  // Botón Eliminar
  fila.querySelector('.btnEliminar').addEventListener('click', function() {
    const rowIndex = Array.from(tbody.children).indexOf(fila);
    if (rowIndex > -1) {
      registros.splice(rowIndex, 1);
      fila.remove();
      document.getElementById('mensaje').textContent = 'Registro eliminado.';
      // Recalcular IDs
      Array.from(tbody.children).forEach((tr, idx) => {
        tr.children[0].textContent = idx + 1;
      });
    }
  });
  // Botón Editar
  fila.querySelector('.btnEditar').addEventListener('click', function() {
    const rowIndex = Array.from(tbody.children).indexOf(fila);
    if (rowIndex > -1) {
      const reg = registros[rowIndex];
      const form = document.getElementById('registroForm');
      form.nombre.value = reg.nombre;
      form.area.value = reg.area;
      // Disparar el evento para habilitar campos
      form.area.dispatchEvent(new Event('change'));
      setTimeout(() => {
        form.codigo.value = reg.codigo;
        form.codigo.dispatchEvent(new Event('input'));
        form.producto.value = reg.producto;
        form.cilindros.value = reg.cilindros;
      }, 10);
      editandoIndice = rowIndex;
      document.querySelector('button[type="submit"]').textContent = 'Actualizar';
      document.getElementById('mensaje').textContent = 'Editando registro. Modifique y presione Actualizar.';
    }
  });
  tbody.appendChild(fila);
}
  </script>
</body>
</html>
